{% extends "base/base-customer.html" %}

{% block title %}The Siren - {{ _("Commodity Detail")}}: {{ model.name }}{% endblock %}



{% block top_css %}
    {# css for bootstrap #}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" crossorigin="anonymous">
{% endblock %}


{#  for links to css #}
{% block style %}
    <link rel="icon" href="../../static/images/half-logo.png">

    <link href="../../static/css/normalize.css" rel="stylesheet" type="text/css">
    <link href="../../static/css/webflow.css" rel="stylesheet" type="text/css">
    <link href="../../static/css/jacks-supercool-site-c6dd88.webflow.css" rel="stylesheet" type="text/css">
    <link href="../../static/css/userinfo/user_profile.css" rel="stylesheet" type="text/css">
    <link href="../../static/css/main/detail_slides_pictures.css" rel="stylesheet" type="text/css">
    <link href="../../static/css/main/detail_video.css" rel="stylesheet" type="text/css">
    <link href="../../static/css/main/detail_3d_view.css" rel="stylesheet" type="text/css">
    <link href="../../static/css/main/comment-display.css" rel="stylesheet" type="text/css">
    <link href="../../static/css/main/commodities_card.css" rel="stylesheet" type="text/css">
    <link href="../../static/css/main/customize_modal.css" rel="stylesheet" type="text/css">
    <!-- [if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"
            type="text/javascript"></script><![endif] -->
    <script type="text/javascript">!function (o, c) {
        var n = c.documentElement, t = " w-mod-";
        n.className += t + "js", ("ontouchstart" in o || o.DocumentTouch && c instanceof DocumentTouch) && (n.className += t + "touch")
    }(window, document);</script>
    <link href="images/favicon.ico" rel="shortcut icon" type="image/x-icon">
    <link href="images/webclip.png" rel="apple-touch-icon">
    <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=6221c36b59f1986aa65ac5f0"
            type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
            crossorigin="anonymous"></script>

    <!-- 3D model required -->
        <script src="../../static/three-d-model-support/three.js-master/build/three.js"></script>
        <script src="../../static/three-d-model-support/three.js-master/build/three.min.js"></script>
        <script src="../../static/three-d-model-support/three.js-master/build/three.module.js"></script>
        <script src="../../static/three-d-model-support/three.js-master/examples/js/controls/OrbitControls.js"></script>
        <script src="../../static/three-d-model-support/three.js-master/examples/js/loaders/OBJLoader.js"></script>
        <!-- <script src="http://www.yanhuangxueyuan.com/versions/threejsR92/build/three.js"></script>-->
        <script src="http://www.yanhuangxueyuan.com/versions/threejsR92/examples/js/loaders/FBXLoader.js"></script>
        <script src="http://www.yanhuangxueyuan.com/versions/threejsR92/examples/js/libs/inflate.min.js"></script>
    <!-- 3D model required end -->

    {# css for product box #}
    <link rel="stylesheet" href="../../static/css/main/product_box.css">

    <style>
        body {
            -moz-osx-font-smoothing: grayscale;
            -webkit-font-smoothing: antialiased;
        }

        select, input, textarea {
            -webkit-appearance: none;
        }
    </style>

    <!-- Fight against the 'import' style in bootstrap -->
    <link href="../../static/css/main/commodity-details-against-bootstrap.css" rel="stylesheet" type="text/css">
{% endblock %}



{# content #}
{% block content %}
    <html data-wf-page="6221c36b59f19896625ac608" data-wf-site="6221c36b59f1986aa65ac5f0">
        <body>

            <div class="section wf-section commodity-main-section">
                <div class="main-container">
                    <div class="w-layout-grid product-grid">

                        {# <img src="{{ url_for('static', filename=model.pictures.first().address) }}" loading="lazy" alt="" class="main-product-image">#}
                        {#        product picture slide #}
                        {#            the outer box contains the picture list and picture selecting button #}
                        {#                    <div class="picture-panel-box">#}
                        {#                        <ul class="pic-container">#}
                        {# loop through all the pictures to make each of them in an list item #}
                        {#                            {% for picture in model.pictures %}#}
                        {#                                <li class="pic">#}
                        {#                                    <img src="{{ url_for('static', filename=picture.address) }}" alt="product-picture">#}
                        {#                                </li>#}
                        {#                            {% endfor %}#}
                        {#                        </ul>#}
                        {##}
                        {# the btn container, wich contains the btn for next and last picture #}
                        {#                        <div class="btn">#}
                        {#                            <div class="btn-left"><</div>#}
                        {#                            <div class="btn-right">></div>#}
                        {#                        </div>#}
                        {#                    </div>#}

{#                        <img#}
{#                                data-wf-sku-bindings="%5B%7B%22from%22%3A%22f_main_image_4dr%22%2C%22to%22%3A%22src%22%7D%5D" loading="lazy"#}
{#                                data-wf-sku-conditions="%7B%22condition%22%3A%7B%22fields%22%3A%7B%22default-sku%3Amore-images%22%3A%7B%22exists%22%3A%22no%22%2C%22type%22%3A%22Set%22%7D%7D%7D%2C%22timezone%22%3A%22Australia%2FMelbourne%22%7D"#}
{#                                src="{{ url_for("static", filename=model.pictures.all()[0].address) }}" alt=""#}
{#                                sizes="100vw"#}
{#                                srcset="https://assets.website-files.com/619d7624f1a47727712de71e/61a564458430d13b4751eebf_product-decor-03-p-500.jpeg 500w, https://assets.website-files.com/619d7624f1a47727712de71e/61a564458430d13b4751eebf_product-decor-03-p-800.jpeg 800w, https://assets.website-files.com/619d7624f1a47727712de71e/61a564458430d13b4751eebf_product-decor-03.jpg 1080w"#}
{#                                class="main-product-image"#}
{#                                style="object-fit: cover">#}

                        <!-- Slide window from bootstrap -->
                        <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
                            <ol class="carousel-indicators">
                                {% for picture in model.pictures %}
                                    <li data-target="#carouselExampleIndicators" data-slide-to="{{ loop.index0 }}" class="{% if loop.index == 1 %}active{% endif %}"></li>
                                {% endfor %}
                            </ol>
                            <div class="carousel-inner">
                                {% for picture in model.pictures %}
                                    <div class="carousel-item {% if loop.index == 1 %}active{% endif %}">
                                        <img src="{{ url_for("static", filename=picture.address) }}" class="d-block w-100" alt="...">
                                    </div>
                                {% endfor %}
                            </div>
                            <button class="carousel-control-prev" type="button" data-target="#carouselExampleIndicators" data-slide="prev">
                                <span class="carousel-control-prev-icon btn-change-pic" aria-hidden="true"></span>
                                <span class="sr-only">{{ _("Previous") }}</span>
                            </button>
                            <button class="carousel-control-next" type="button" data-target="#carouselExampleIndicators" data-slide="next">
                                <span class="carousel-control-next-icon btn-change-pic" aria-hidden="true"></span>
                                <span class="sr-only">{{ _("Next") }}</span>
                            </button>
                        </div>


                        <!-- Vertical Border (The Divider Line) -->
                        <div id="w-node-c7e51d0f-2d88-d3ea-4d4e-74172b8dc048-625ac608" class="vertical-border"></div>

                        <!-- Right side section of upper section -->
                        <div class="product-description">

                            <!-- Hierarchical table of content on the top -->
                            <div class="breadcrumbs">
                                <!-- The whole shop -->
                                <a href="{{ url_for("main.go_all") }}">{{ _("Shop") }}</a>

                                <img src="{{ url_for("static", filename="images/icon-caret-right.svg") }}" loading="lazy" alt="" class="breadcrumb-arrow">

                                <!-- The category -->
                                <div class="w-dyn-list">
                                    <div role="list" class="w-dyn-items">
                                        <div role="listitem" class="w-dyn-item">
                                            <a href="{{ url_for("main.products_in_category", cate_name=model.product.categories.all()[0].name) }}">{{ model.product.categories.all()[0].name }}</a>
                                        </div>
                                    </div>
                                </div>

                                <img src="{{ url_for("static", filename="images/icon-caret-right.svg") }}" loading="lazy" alt="" class="breadcrumb-arrow">

                                <!-- The brand -->
                                <div class="w-dyn-list">
                                    <div role="list" class="w-dyn-items">
                                        <div role="listitem" class="w-dyn-item">
                                            <a href="#model-details-brand-section">{{ model.product.brand.name }}</a>
                                        </div>
                                    </div>
                                </div>

                                <img src="{{ url_for("static", filename="images/icon-caret-right.svg") }}" loading="lazy" alt="" class="breadcrumb-arrow">

                                <!-- The current model type -->
                                <div class="w-dyn-list">
                                    <div role="list" class="w-dyn-items">
                                        <div role="listitem" class="w-dyn-item">
                                            <a href="{{ url_for("main.model_type_details", mt_id=model.id) }}">{{ model.name }}</a>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Model Name Section -->
                            <h1 class="medium-heading">{{ model.name }}</h1>

                            <!-- rating stars of this product -->
                            <div class="box-product-rate">
                                <ul class="box-rate-stars">
                                    {% if (model.rate // 1) == 0 %}
                                        <li class="star-dark">&#9733</li>
                                        <li class="star-dark">&#9733</li>
                                        <li class="star-dark">&#9733</li>
                                        <li class="star-dark">&#9733</li>
                                        <li class="star-dark">&#9733</li>
                                    {% elif (model.rate // 1) == 1 %}
                                        <li class="star-bright">&#9733</li>
                                        <li class="star-dark">&#9733</li>
                                        <li class="star-dark">&#9733</li>
                                        <li class="star-dark">&#9733</li>
                                        <li class="star-dark">&#9733</li>
                                    {% elif (model.rate // 1) == 2 %}
                                        <li class="star-bright">&#9733</li>
                                        <li class="star-bright">&#9733</li>
                                        <li class="star-dark">&#9733</li>
                                        <li class="star-dark">&#9733</li>
                                        <li class="star-dark">&#9733</li>
                                    {% elif (model.rate // 1) == 3 %}
                                        <li class="star-bright">&#9733</li>
                                        <li class="star-bright">&#9733</li>
                                        <li class="star-bright">&#9733</li>
                                        <li class="star-dark">&#9733</li>
                                        <li class="star-dark">&#9733</li>
                                    {% elif (model.rate // 1) == 4 %}
                                        <li class="star-bright">&#9733</li>
                                        <li class="star-bright">&#9733</li>
                                        <li class="star-bright">&#9733</li>
                                        <li class="star-bright">&#9733</li>
                                        <li class="star-dark">&#9733</li>
                                    {% elif (model.rate // 1) == 5 %}
                                        <li class="star-bright">&#9733</li>
                                        <li class="star-bright">&#9733</li>
                                        <li class="star-bright">&#9733</li>
                                        <li class="star-bright">&#9733</li>
                                        <li class="star-bright">&#9733</li>
                                    {% endif %}
                                </ul>
                            </div>

                            <!-- Price Section -->
                            <div class="price-container large-text">
                                <div class="old-price increased-margin">￥{{ model.price*2 }}</div>
                                <div>￥{{ model.price }}</div>
                                <div></div>
                            </div>

                            <!-- The outer container of rest things of the upper part in this page -->
                            <div class="w-layout-grid product-details-grid">
                                <!-- Description Section -->
                                <div>
                                    <h6 class="uppercase-text product-details-heading">{{ _("Description") }}</h6>
                                    <div>{{ model.description }}</div>
                                </div>

                                <!-- Detail List Section -->
                                {#                            <div>#}
                                {#                                <h6 class="uppercase-text product-details-heading">details</h6>#}
                                {#                                <div class="product-details-list w-richtext">#}
                                {#                                    <ul class="product-details-list">#}
                                {#                                        <li>质量高达3kg，品质首选</li>#}
                                {#                                        <li>自带加湿功能</li>#}
                                {#                                        <li>工作一天仅需5元食物</li>#}
                                {#                                        <li>质保期限：直到您的墩布退休！</li>#}
                                {#                                    </ul>#}
                                {#                                </div>#}
                                {#                            </div>#}

                                <!-- Specification Table Section -->
                                <div>
                                    <h6 class="uppercase-text product-details-heading">{{ _("Specification Table")}}</h6>
                                    <div class="product-dimensions">
                                        <div>
                                            <div class="dimensions-heading">{{ _("Weight") }}</div>
                                            <div>{{ model.weight }} <i>kg</i></div>
                                        </div>
                                        <div>
                                            <div class="dimensions-heading">{{ _("Views") }}</div>
                                            <div>{{ model.get_formatted_views() }}</div>
                                        </div>
                                        <div>
                                            <div class="dimensions-heading">{{ _("Sales") }}</div>
                                            <div>{{ model.get_formatted_sales() }} <i>{{ _("times") }}</i></div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Customization Section -->
                                <div>
                                    <h6 class="uppercase-text product-details-heading">{{ _("Customization") }}</h6>
                                    <div class="form-group">
                                        <div class="select-wrapper">
                                            <select id="select-model-type" name="select-type" data-name="field" class="select-field w-select">

                                                <optgroup label="Available Model Types">
                                                    {% for mt in model.product.model_types %}
                                                        <option value="{{ url_for("main.model_type_details", mt_id=mt.id) }}"
                                                                {% if mt.id == model.id %}selected="selected"{% endif %}>
                                                            {{ mt.name }}
                                                        </option>
                                                    {% endfor %}
                                                </optgroup>

                                                {% if model.three_d_model_address != None and model.three_d_model_address != "" %}
                                                    <optgroup label="Customize with your own idea">
                                                        <option value="#modeltype-3d-model">
                                                            {{ _("Customize the Appearance") }}
                                                        </option>
                                                    </optgroup>
                                                {% endif %}
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <!-- Additional Info Section -->
                                <div>
                                    <h6 class="uppercase-text product-details-heading">{{ _("Additional information")}}</h6>
                                    <div class="product-description">{{ _("Please Notice that this is a consumable product
                                            and
                                            cannot be refunded once sold after 7-days.")}}
                                    </div>
                                </div>

                                <div>
                                    {% if model.is_deleted == False %}
                                        {% if model.stock > 0 %}
                                            <!-- The Purchase Module -->
                                            <form data-node-type="commerce-add-to-cart-form"
                                                  class="w-commerce-commerceaddtocartform cart-default-state">
                                                <div class="add-to-cart-form">
                                                    <div class="quantity-wrapper">
                                                        <label for="quantity-6194caf15498d8612861f033e8278855" class="quantity-label">{{ _("Quantity") }}:</label>
                                                        <input type="number" pattern="^[0-9]$"
                                                               inputmode="numeric"
                                                               id="quantity-6194caf15498d8612861f033e8278855"
                                                               name="commerce-add-to-cart-quantity-input"
                                                               min="1" class="w-commerce-commerceaddtocartquantityinput quantity-input"
                                                               value="1">
                                                    </div>
                                                    <input id="btn-add-to-cart" type="submit"
                                                           data-node-type="commerce-add-to-cart-button"
                                                           data-loading-text="Adding to cart..." value="{{ _("Add to Cart") }}"
                                                           class="w-commerce-commerceaddtocartbutton button small">
                                                </div>
                                                <div id="btn-buy-now" model_id="{{ model.id }}" href="#"
                                                   data-node-type="commerce-buy-now-button" data-default-text="Buy It Now"
                                                   data-subscription-text="Subscribe now"
                                                   class="w-commerce-commercebuynowbutton button no-top-margin bg-primary">
                                                    {{ _("Buy
                                                            It Now")}}</div>
                                            </form>

                                        {% else %}
                                            <!-- Out of stock statement -->
                                            <div class="w-commerce-commerceaddtocartoutofstock empty-state">
                                                <h1 class="uppercase-text large-text" style="color: darkred">{{ _("This
                                                        item runs out of stock.")}}</h1>
                                            </div>
                                        {% endif %}

                                    {% else %}
                                        <!-- Sold out statement -->
                                        <div class="w-commerce-commerceaddtocartoutofstock empty-state">
                                            <h1 class="uppercase-text product-details-heading" style="color: darkred">
                                                {{ _("This
                                                        item is no longer available (Sold out).")}}</h1>
                                        </div>
                                    {% endif %}


                                    <!-- add to cart error statements -->
                                    {#                                <div data-node-type="commerce-add-to-cart-error" style="display:none"#}
                                    {#                                     class="w-commerce-commerceaddtocarterror form-error">#}
                                    {#                                    <div data-node-type="commerce-add-to-cart-error"#}
                                    {#                                         data-w-add-to-cart-quantity-error="Product is not available in this quantity."#}
                                    {#                                         data-w-add-to-cart-general-error="Something went wrong when adding this item to the cart."#}
                                    {#                                         data-w-add-to-cart-mixed-cart-error="You canâ€™t purchase another product with a subscription."#}
                                    {#                                         data-w-add-to-cart-buy-now-error="Something went wrong when trying to purchase this item."#}
                                    {#                                         data-w-add-to-cart-checkout-disabled-error="Checkout is disabled on this site."#}
                                    {#                                         data-w-add-to-cart-select-all-options-error="Please select an option in each set.">#}
                                    {#                                        Product is not available in this quantity.#}
                                    {#                                    </div>#}
                                    {#                                </div>#}

                                </div>
                                <div class="fine-print-text muted">{{ _("This product supports 7-days refund and the quality
                                        is
                                        guaranteed.")}}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 3d implementation for testing-->
{#            {% if model.id == 28 %}#}
{#                <br>#}
{#                <div id="modeltype-3d-model"  class="section bg-primary-dark wf-section">#}
{#                    <div class="main-container">#}
{#                        <div class="w-layout-grid grid-halves">#}
                            {# title of 3D view #}
{#                            <div class="container">#}
{#                                <h1 class="no-bottom-margin view-3d-title">{{ _("3D view of")}} {{ model.name }}</h1>#}
{#                            </div>#}
                            {# container of the 3D view #}
{#                            <div class="container">#}
{#                                <div class="section-title more-from-brand-title view-3d">#}
{#                                    <script id="3d_display_section" async#}
{#                                            src="https://api.cappasity.com/api/player/cappasity-ai"></script>#}
{#                                    <iframe width="100%" height="600px" frameborder="0" allowfullscreen#}
{#                                            mozallowfullscreen="true"#}
{#                                            webkitallowfullscreen="true" style="border:0;"#}
{#                                            src="https://api.cappasity.com/api/player/e5ee3fda-6cff-4e34-972e-eeb8720ad538/embedded?autorun=0&closebutton=1&logo=0&analytics=1&uipadx=0&uipady=0&enablestoreurl=0&storeurl=&hidehints=0&language=&autorotate=0&autorotatetime=3.282909393310547&autorotatedelay=2&autorotatedir=1&hidefullscreen=1&hideautorotateopt=0&hidesettingsbtn=0&enableimagezoom=1&zoomquality=1&hidezoomopt=0&arbutton=1"></iframe>#}
{#                                    <h3 class="no-bottom-margin"></h3>#}
{#                                </div>#}
{#                            </div>#}
{#                        </div>#}
{#                    </div>#}
{#                </div>#}

             <!-- new implementation of 3D model (using webgl) -->
            {% if model.three_d_model_address != None and model.three_d_model_address != "" %}
                <br>
                <div id="modeltype-3d-model" class="section bg-primary-dark wf-section"
                     model-address="{{ url_for("static", filename=model.three_d_model_address) }}"
                     model-texture-address="{{ url_for("static", filename=model.three_d_model_texture_address) }}">
                    <div class="main-container">
                        <div class="w-layout-grid grid-halves">
                            {# title of 3D view #}
                            <div class="container">
                                <h1 class="no-bottom-margin view-3d-title">{{ _("3D view of") }} {{ model.name }}</h1>
                                <div>
                                    <br>
                                    {{ _("You can use mouse to move the camara around by dragging and use mouse wheel to move
                                            closer.") }} <br><br>
                                    {{ _("You may wait for a moment before the source download is finished, this may take several
                                            minuses.") }} <br><br>
                                    {{ _("If you cannot see the 3d model when the source is ready, please move the camara.") }}
                                    <br>
                                    <br>
                                </div>
                                {% if current_user.is_authenticated %}
                                    <a id="customize-texture-btn" href="#" class="button bg-white-faded w-inline-block">
                                        <div>{{ _("Customize Yours") }}</div>
                                    </a>
                                {% else %}
                                    <a href="{{ url_for('auth.login') }}" class="button bg-white-faded w-inline-block">
                                        <div>{{ _("Customize Yours") }}</div>
                                    </a>
                                {% endif %}
                            </div>
                            {# container of the 3D view #}
                            <div class="container">
                                <div class="section-title more-from-brand-title view-3d">
                                    <div id="webgl-output" class="grab">

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            {% endif %}



            {# video section about this model #}
            {% if model.video_address != None and model.video_address != "" %}
                <div class="section bg-primary-dark wf-section">
                    <div class="main-container">
                        <div class="video-and-title-box">
                            {# the title (left) #}
                            <div class="container video-title">
                                <h6 class="uppercase-text large-heading">{{ _("Video for showing")}}</h6>
                                <h3 class="medium-heading"></h3>
                                <div class="large-text"></div>
                            </div>
                            <div class="container">
                                {# The video (right) #}
                                <video controls>
                                    <source src="{{ url_for("static", filename=model.video_address) }}" type="video/mp4">
                                </video>
                            </div>
                        </div>
                    </div>
                </div>

                <br><br>
            {% endif %}

            {# radio section about this model #}
            {% if model.audio_addresses.count() != 0 %}
                <div class="section bg-primary-dark wf-section">
                    <div class="main-container">
                        <div class="video-and-title-box">
                            {# the title (left) #}
                            <div class="container video-title">
                                <h6 class="uppercase-text large-heading">{{ _("Audio Samples")}}</h6>
                                <h3 class="medium-heading"></h3>
                                <div class="large-text"></div>
                            </div>
                            <div class="container">
                                {# The audio list (right) #}
                                {% for au in model.audio_addresses %}
                                    <audio controls>
                                        <source src="{{ url_for("static", filename=au.address) }}" type="audio/mpeg">
                                    </audio>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>

                <br><br>
            {% endif %}

            <!-- comments section about this model -->
            {% if model.comments.count() != 0 %}
                <div class="main-container">
                    <div class="">
                        <div>
                            <h3 id="comment-section-title" class="no-bottom-margin">{{ _("Comments") }}</h3>
                            <h3 class="medium-heading"></h3>
                            <div class="large-text"></div>
                        </div>
                        <table class="comments-table">
                            {% for comment in model.comments.order_by(Comment.timestamp.desc()) %}
                                <tr class="comment-row">
                                    <td class="tight-wrapper-col">
                                        <table class="author-table">
                                            <tr>
                                                <td class="avatar-col">
                                                    <!-- the avatar image -->
                                                    <img id="avatar" alt="user-avatar" src="{{ url_for('static', filename=comment.author.avatar) }}">
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="level-cell {% if comment.author.is_premium == true %}bright{% endif %}">
                                                    Lv.{{ comment.author.get_level() }}
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <div>
                                                        <span class="name-cell">
                                                            {% if comment.author.is_premium == true %}
                                                                <img class="premium-mark" src="../../static/images/user/prime1.png">
                                                            {% else %}
                                                                <img class="premium-mark" src="../../static/images/user/prime0.png"></a>
                                                            {% endif %}
                                                            {{ comment.author.username }}
                                                        </span>
                                                    </div>
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                    <td>
                                        <table class="comment-content-table">
                                            <tr>
                                                <td colspan="2" class="content-cell">
                                                    {{ comment.content }}
                                                </td>
                                            </tr>
                                            <tr>
                                                <td colspan="2">
                                                    <div class="comment-pic-section">
                                                        {% for pic in comment.pictures %}
                                                            <img src="{{ url_for('static', filename=pic .address) }}" class="comment-pic" loading="lazy" alt="">
                                                        {% endfor %}
                                                    </div>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="rate-col">
                                                    <div>
                                                        <div class="no-bottom-margin box-product-rate">
                                                            <ul class="box-rate-stars">
                                                                {% if (comment.star_num // 1) == 0 %}
                                                                    <li class="star-dark">&#9733</li>
                                                                    <li class="star-dark">&#9733</li>
                                                                    <li class="star-dark">&#9733</li>
                                                                    <li class="star-dark">&#9733</li>
                                                                    <li class="star-dark">&#9733</li>
                                                                {% elif (comment.star_num // 1) == 1 %}
                                                                    <li class="star-bright">&#9733</li>
                                                                    <li class="star-dark">&#9733</li>
                                                                    <li class="star-dark">&#9733</li>
                                                                    <li class="star-dark">&#9733</li>
                                                                    <li class="star-dark">&#9733</li>
                                                                {% elif (comment.star_num // 1) == 2 %}
                                                                    <li class="star-bright">&#9733</li>
                                                                    <li class="star-bright">&#9733</li>
                                                                    <li class="star-dark">&#9733</li>
                                                                    <li class="star-dark">&#9733</li>
                                                                    <li class="star-dark">&#9733</li>
                                                                {% elif (comment.star_num // 1) == 3 %}
                                                                    <li class="star-bright">&#9733</li>
                                                                    <li class="star-bright">&#9733</li>
                                                                    <li class="star-bright">&#9733</li>
                                                                    <li class="star-dark">&#9733</li>
                                                                    <li class="star-dark">&#9733</li>
                                                                {% elif (comment.star_num // 1) == 4 %}
                                                                    <li class="star-bright">&#9733</li>
                                                                    <li class="star-bright">&#9733</li>
                                                                    <li class="star-bright">&#9733</li>
                                                                    <li class="star-bright">&#9733</li>
                                                                    <li class="star-dark">&#9733</li>
                                                                {% elif (comment.star_num // 1) == 5 %}
                                                                    <li class="star-bright">&#9733</li>
                                                                    <li class="star-bright">&#9733</li>
                                                                    <li class="star-bright">&#9733</li>
                                                                    <li class="star-bright">&#9733</li>
                                                                    <li class="star-bright">&#9733</li>
                                                                {% endif %}
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td class="timestamp-col">
                                                    <div class="timestamp-cell">
                                                        {{ comment.timestamp.strftime("%Y-%m-%d %H:%M:%S") }}
                                                    </div>
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                            {% endfor %}
                        </table>
                    </div>
                </div>

                <br><br>
            {% endif %}

            {# about this brand #}
            <div class="section bg-primary-dark wf-section" id="model-details-brand-section">
                <div class="main-container">
                    <div class="w-layout-grid grid-halves">
                        <div class="container">
                            <h6 class="uppercase-text large-heading">{{ _("About this brand - ")}}{{ model.product.brand.name }}</h6>
                            <h3 class="medium-heading"></h3>
                            <div class="large-text"></div>
                            <div class="button-row">
                                <a href="{{ url_for("main.brand_intro", brand_id=model.product.brand.id) }}" class="button bg-white-faded w-inline-block">
                                    <div>{{ _("Learn More")}}</div>
                                </a>
                            </div>
                        </div>
                        <div class="container">
                            {% if model.product.brand.logo %}
                                <img src="{{ url_for("static", filename=model.product.brand.logo) }}" loading="lazy" alt="" class="img-brand-logo-in-mt-details-page">
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>



            {# more products from this brand #}
            <div class="section bg-primary-light wf-section">
                <div class="main-container">
                    <h3 class="no-bottom-margin section-title-in-mt-detail-page">{{ _("More from ")}}{{ model.product.brand.name }}</h3>
                    <div class="w-dyn-list">
                        <div role="list" class="product-quarters-grid w-dyn-items">
                            {% if more_mt_this_brand|length >= 1 %}
                                {% for mt in more_mt_this_brand %}
{#                                    <div role="listitem" class="w-dyn-item">#}
{#                                        <div>#}
{#                                            <a href="#" class="product-preview-link w-inline-block"><img#}
{#                                                    src="{{ url_for('static', filename=related.pictures.first().address) }}"#}
{#                                                    loading="lazy" alt="" class="product-thumbnail">#}
{#                                                <div class="uppercase-text brand"></div>#}
{#                                                <h5 class="no-bottom-margin"></h5>#}
{#                                                <div class="price-container">#}
{#                                                    <div class="old-price"></div>#}
{#                                                    <div></div>#}
{#                                                    <div></div>#}
{#                                                </div>#}
{#                                            </a>#}
{#                                        </div>#}
{#                                    </div>#}
                                    <div role="listitem" class="w-dyn-item commodity-card">
                                        <div>
                                            {#                          <a href="{{ url_for("main.model_type_details", mt_id=mt.id) }}" class="product-preview-link w-inline-block">#}
                                            <a href="/product-details/{{ mt.id }}" class="product-preview-link w-inline-block">
                                                {#                              <img src="{{ url_for("static",filename=mt.pictures.first().address) }}" loading="lazy" alt="" class="product-thumbnail">#}
                                                <div class="commodity-pic
                                                     {% if (mt.video_address == None or mt.video_address == "") and (mt.audio_addresses.count() == 0) and (mt.three_d_model_address != None and mt.three_d_model_address != "") %}
                                                        commodity-pic1
                                                     {% elif (mt.video_address == None or mt.video_address == "") and (mt.audio_addresses.count() != 0) and (mt.three_d_model_address == None or mt.three_d_model_address == "") %}
                                                        commodity-pic2
                                                     {% elif (mt.video_address != None and mt.video_address != "") and (mt.audio_addresses.count() == 0) and (mt.three_d_model_address == None or mt.three_d_model_address == "") %}
                                                        commodity-pic3
                                                     {% elif (mt.video_address != None and mt.video_address != "") and (mt.audio_addresses.count() != 0) and (mt.three_d_model_address == None or mt.three_d_model_address == "") %}
                                                        commodity-pic4
                                                     {% elif (mt.video_address != None and mt.video_address != "") and (mt.audio_addresses.count() == 0) and (mt.three_d_model_address != None and mt.three_d_model_address != "") %}
                                                        commodity-pic5
                                                     {% elif (mt.video_address == None or mt.video_address == "") and (mt.audio_addresses.count() != 0) and (mt.three_d_model_address != None and mt.three_d_model_address != "") %}
                                                        commodity-pic6
                                                     {% elif (mt.video_address != None and mt.video_address != "") and (mt.audio_addresses.count() != 0) and (mt.three_d_model_address != None and mt.three_d_model_address != "") %}
                                                        commodity-pic7
                                                     {% endif %}">
                                                    <img src="../../static/{{ mt.pictures.first().address }}"
                                                         loading="lazy" alt="" class="product-thumbnail">
                                                </div>
                                                <div class="uppercase-text brand brand-row">{{ mt.product.brand.name }}</div>
                                                <h5 class="no-bottom-margin">{{ mt.name }}</h5>
                                                <div class="price-container">
                                                    <div class="old-price"><span>￥</span>{{ mt.price*2 }}</div>
                                                    <div><span>￥</span>{{ mt.price }}</div>
                                                </div>
                                            </a>
                                        </div>
                                    </div>
                                {% endfor %}
                            {% endif %}
                        </div>
                        {% if more_mt_this_brand|length == 0 %}
                            <div class="empty-state bg-primary w-dyn-empty">
                                <div>{{ _("There are no more products from this brand yet.")}}</div>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>


            <!-- Related Recommendation Section -->
            <div class="section wf-section">
                <div class="main-container">
                    <div class="section-title more-from-brand-title">
                        <h3 class="no-bottom-margin section-title-in-mt-detail-page">{{ _("Related Recommendation")}}</h3>
                        <div class="w-dyn-list">
                            <div role="list" class="w-dyn-items">
                                <div role="listitem" class="w-dyn-item">
                                    <h3 class="no-bottom-margin"></h3>
                                </div>
                            </div>
                            {% if model.name == none %}
                                <div class="w-dyn-empty">
                                    <div>{{ _("No items found.")}}</div>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                    <div class="w-dyn-list">
                        <div role="list" class="product-quarters-grid w-dyn-items">
                            {% if related_mt_lst|length >= 1 %}
                                {% for mt in related_mt_lst %}
{#                                    <div role="listitem" class="w-dyn-item">#}
{#                                        <div>#}
{#                                            <a href="#" class="product-preview-link w-inline-block"><img#}
{#                                                    src="{{ url_for('static', filename=related.pictures.first().address) }}"#}
{#                                                    loading="lazy" alt="" class="product-thumbnail">#}
{#                                                <div class="uppercase-text brand"></div>#}
{#                                                <h5 class="no-bottom-margin"></h5>#}
{#                                                <div class="price-container">#}
{#                                                    <div class="old-price"></div>#}
{#                                                    <div></div>#}
{#                                                    <div></div>#}
{#                                                </div>#}
{#                                            </a>#}
{#                                        </div>#}
{#                                    </div>#}
                                    <div role="listitem" class="w-dyn-item commodity-card">
                                        <div>
                                            {#                          <a href="{{ url_for("main.model_type_details", mt_id=mt.id) }}" class="product-preview-link w-inline-block">#}
                                            <a href="/product-details/{{ mt.id }}" class="product-preview-link w-inline-block">
                                                {#                              <img src="{{ url_for("static",filename=mt.pictures.first().address) }}" loading="lazy" alt="" class="product-thumbnail">#}
                                                <div class="commodity-pic
                                                     {% if (mt.video_address == None or mt.video_address == "") and (mt.audio_addresses.count() == 0) and (mt.three_d_model_address != None and mt.three_d_model_address != "") %}
                                                        commodity-pic1
                                                     {% elif (mt.video_address == None or mt.video_address == "") and (mt.audio_addresses.count() != 0) and (mt.three_d_model_address == None or mt.three_d_model_address == "") %}
                                                        commodity-pic2
                                                     {% elif (mt.video_address != None and mt.video_address != "") and (mt.audio_addresses.count() == 0) and (mt.three_d_model_address == None or mt.three_d_model_address == "") %}
                                                        commodity-pic3
                                                     {% elif (mt.video_address != None and mt.video_address != "") and (mt.audio_addresses.count() != 0) and (mt.three_d_model_address == None or mt.three_d_model_address == "") %}
                                                        commodity-pic4
                                                     {% elif (mt.video_address != None and mt.video_address != "") and (mt.audio_addresses.count() == 0) and (mt.three_d_model_address != None and mt.three_d_model_address != "") %}
                                                        commodity-pic5
                                                     {% elif (mt.video_address == None or mt.video_address == "") and (mt.audio_addresses.count() != 0) and (mt.three_d_model_address != None and mt.three_d_model_address != "") %}
                                                        commodity-pic6
                                                     {% elif (mt.video_address != None and mt.video_address != "") and (mt.audio_addresses.count() != 0) and (mt.three_d_model_address != None and mt.three_d_model_address != "") %}
                                                        commodity-pic7
                                                     {% endif %}">
                                                    <img src="../../static/{{ mt.pictures.first().address }}"
                                                         loading="lazy" alt="" class="product-thumbnail">
                                                </div>
                                                <div class="uppercase-text brand brand-row">{{ mt.product.brand.name }}</div>
                                                <h5 class="no-bottom-margin">{{ mt.name }}</h5>
                                                <div class="price-container">
                                                    <div class="old-price"><span>￥</span>{{ mt.price*2 }}</div>
                                                    <div><span>￥</span>{{ mt.price }}</div>
                                                </div>
                                            </a>
                                        </div>
                                    </div>
                                {% endfor %}
                            {% endif %}
                        </div>
                        {% if related_mt_lst|length == 0 %}
                            <div class="empty-state bg-primary w-dyn-empty">
                                <div>{{ _("There are no more products from this category yet.")}}</div>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- Subscribe Section -->
            <div class="section bg-dark wf-section">
                <div class="main-container">
                    <div class="w-layout-grid grid-halves">
                        <div class="w-layout-grid social-images">
                            <img src="../../static/images/index/guitar.jpg" loading="lazy" alt="">
                            <img src="../../static/images/index/wind.jpg" loading="lazy" alt="">
                            <img src="../../static/images/index/keyboard.jpg" loading="lazy" alt="">
                        </div>
                        <div class="text-center">
                            <h4 class="medium-heading slogan">{{ _('Music should strike fire from the heart of man.') }}</h4>
                            <h6 class="small-heading slogan_name">{{ _('Beethoven') }}</h6>
                            <div class="button-row justify-content-center">
                                <a href="{{ url_for('auth.register') }}" target="_blank"
                                   class="button bg-white-faded w-inline-block">
                                    <div>{{ _('Start Voyage') }}</div>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- blocker & floating section -->
            <div id="detail_blocker" class="middle-floating blocker" style="display: none"></div>

            <!-- Change avatar floating section-->
            <div id="change_texture_form" class="middle-floating bg-grey action_area" style="display: none">
                <div id="close_change_texture_form_btn" class="close_btn">
                    &times;
                </div>
                <div id="form_top_bar" class="medium-heading">
                    {{ _("Customize Yours")}}
                </div>
                <form id="upload_texture_form" enctype="multipart/form-data" method="post" novalidate class="action-table-form">
                    <table class="action_table">
                        <tr>
                            <td>
                                <div>
                                    <div class="form-group">
                                        <label>{{ _("Texture (.png only)") }}</label>
                                        <input type="file" name="customized_texture_file" accept="image/png">
                                        <div class="middle submit_btn">
                                            <input class="button bg-primary middle small clickable"
                                                   id="upload_texture_submit" name="update_avatar_submit"
                                                   value="Upload Texture">
                                        </div>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </table>
                </form>
            </div>

            <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=6221c36b59f1986aa65ac5f0"
                    type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
                    crossorigin="anonymous"></script>
            <script type="text/javascript" src="../../static/js/webflow.js"></script>
            <!-- [if lte IE 9]>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script>
            <![endif] -->
            <script src="../../static/js/main/detail_slides_pictures.js" type="text/javascript"></script>
            <script src="../../static/js/main/detail_purchase_section.js" type="text/javascript"></script>
            <script type="text/javascript" src="../../static/js/cart/sidebar_cart.js"></script>
            <script type="text/javascript" src="../../static/js/main/hover_commodity_3d_view.js"></script>
            <script type="text/javascript" src="../../static/js/main/commodity-customization.js"></script>
            <script type="text/javascript" src="../../static/js/main/three-js.js"></script>
            <script type="text/javascript" src="../../static/js/main/grab.js"></script>

            <!-- js for Bootstrap -->
            <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" crossorigin="anonymous"></script>
            <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
        </body>
    </html>
{% endblock %}